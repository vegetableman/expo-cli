{"version":3,"file":"webpack.config.js","sourceRoot":"","sources":["../src/webpack.config.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-ignore\nimport WebpackPWAManifestPlugin from '@expo/webpack-pwa-manifest-plugin';\nimport InterpolateHtmlPlugin from 'react-dev-utils/InterpolateHtmlPlugin';\nimport { Options, Configuration, HotModuleReplacementPlugin, Output } from 'webpack';\n// @ts-ignore\nimport WebpackDeepScopeAnalysisPlugin from 'webpack-deep-scope-plugin';\n// @ts-ignore\nimport CleanWebpackPlugin from 'clean-webpack-plugin';\n// @ts-ignore\nimport ModuleNotFoundPlugin from 'react-dev-utils/ModuleNotFoundPlugin';\n// @ts-ignore\nimport PnpWebpackPlugin from 'pnp-webpack-plugin';\nimport ModuleScopePlugin from 'react-dev-utils/ModuleScopePlugin';\nimport ManifestPlugin from 'webpack-manifest-plugin';\nimport WatchMissingNodeModulesPlugin from 'react-dev-utils/WatchMissingNodeModulesPlugin';\n// @ts-ignore\nimport MiniCssExtractPlugin from 'mini-css-extract-plugin';\nimport CopyWebpackPlugin from 'copy-webpack-plugin';\nimport { boolish } from 'getenv';\nimport { getPathsAsync, getPublicPaths } from './utils/paths';\nimport createAllLoaders from './loaders/createAllLoaders';\nimport { ExpoDefinePlugin, ExpoProgressBarPlugin, ExpoHtmlWebpackPlugin } from './plugins';\nimport { getModuleFileExtensions } from './utils';\nimport withOptimizations from './withOptimizations';\nimport withReporting from './withReporting';\nimport withCompression from './withCompression';\n\nimport path from 'path';\nimport webpack from 'webpack';\n\nimport createDevServerConfigAsync from './createDevServerConfigAsync';\nimport { Arguments, DevConfiguration, FilePaths, Mode } from './types';\n\nimport {\n  DEFAULT_ALIAS,\n  overrideWithPropertyOrConfig,\n} from './utils/config';\nimport getMode from './utils/getMode';\nimport getConfig from './utils/getConfig';\nimport { Environment } from './types';\n\nfunction createNoJSComponent(message: string): string {\n  // from twitter.com\n  return `\" <form action=\"location.reload()\" method=\"POST\" style=\"background-color:#fff;position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999;\"><div style=\"font-size:18px;font-family:Helvetica,sans-serif;line-height:24px;margin:10%;width:80%;\"> <p>${message}</p> <p style=\"margin:20px 0;\"> <button type=\"submit\" style=\"background-color: #4630EB; border-radius: 100px; border: none; box-shadow: none; color: #fff; cursor: pointer; font-weight: bold; line-height: 20px; padding: 6px 16px;\">Reload</button> </p> </div> </form> \"`;\n}\n\nfunction getDevtool(\n  { production, development }: { production: boolean; development: boolean },\n  { devtool }: { devtool?: Options.Devtool }\n): Options.Devtool {\n  if (production) {\n    // string or false\n    if (devtool !== undefined) {\n      // When big assets are involved sources maps can become expensive and cause your process to run out of memory.\n      return devtool;\n    }\n    return 'source-map';\n  }\n  if (development) {\n    return 'cheap-module-source-map';\n  }\n  return false;\n}\n\nfunction getOutput(locations: FilePaths, mode: Mode, publicPath: string): Output {\n  const commonOutput: Output = {\n      sourceMapFilename: '[chunkhash].map',\n      // We inferred the \"public path\" (such as / or /my-project) from homepage.\n      // We use \"/\" in development.\n      publicPath,\n      // Build folder (default `web-build`)\n      path: locations.production.folder,\n  }\n\n  if (mode === 'production') {\n    commonOutput.filename = 'static/js/[name].[contenthash:8].js';\n    // There are also additional JS chunk files if you use code splitting.\n    commonOutput.chunkFilename = 'static/js/[name].[contenthash:8].chunk.js';\n    // Point sourcemap entries to original disk location (format as URL on Windows)\n    commonOutput.devtoolModuleFilenameTemplate = (info: webpack.DevtoolModuleFilenameTemplateInfo): string =>\n      locations.absolute(info.absoluteResourcePath).replace(/\\\\/g, '/');\n  } else {\n    // Add comments that describe the file import/exports.\n    // This will make it easier to debug.\n    commonOutput.pathinfo = true;\n    // Give the output bundle a constant name to prevent caching.\n    // Also there are no actual files generated in dev.\n    commonOutput.filename = 'static/js/bundle.js';\n    // There are also additional JS chunk files if you use code splitting.\n    commonOutput.chunkFilename = 'static/js/[name].chunk.js';\n    // Point sourcemap entries to original disk location (format as URL on Windows)\n    commonOutput.devtoolModuleFilenameTemplate = (info: webpack.DevtoolModuleFilenameTemplateInfo): string =>\n      path.resolve(info.absoluteResourcePath).replace(/\\\\/g, '/');\n  }\n\n  return commonOutput;\n}\n\n\nexport default async function(env: Environment, argv: Arguments = {}): Promise<Configuration | DevConfiguration> {\n  const config = getConfig(env);\n  const mode = getMode(env);\n  const isDev = mode === 'development';\n  const isProd = mode === 'production';\n\n  // Enables deep scope analysis in production mode.\n  // Remove unused import/exports\n  // override: `env.removeUnusedImportExports`\n  const deepScopeAnalysisEnabled = overrideWithPropertyOrConfig(\n    env.removeUnusedImportExports,\n    false\n    // isProd\n  );\n\n  const locations = env.locations || (await getPathsAsync(env.projectRoot));\n\n  const { publicPath, publicUrl } = getPublicPaths(env);\n\n  const { build: buildConfig = {}, lang } = config.web;\n  const { rootId, babel: babelAppConfig = {} } = buildConfig;\n  const { noJavaScriptMessage } = config.web.dangerous;\n  const noJSComponent = createNoJSComponent(noJavaScriptMessage);\n\n  const devtool = getDevtool({ production: isProd, development: isDev }, buildConfig);\n\n  const babelProjectRoot = babelAppConfig.root || locations.root;\n\n  const appEntry: string[] = [];\n\n  // In solutions like Gatsby the main entry point doesn't need to be known.\n  if (locations.appMain) {\n    appEntry.push(locations.appMain);\n  } else {\n    throw new Error(\n      `The entry point for your project couldn't be found. Please define it in the package.json main field`\n    );\n  }\n\n  if (isDev) {\n    // https://github.com/facebook/create-react-app/blob/e59e0920f3bef0c2ac47bbf6b4ff3092c8ff08fb/packages/react-scripts/config/webpack.config.js#L144\n    // Include an alternative client for WebpackDevServer. A client's job is to\n    // connect to WebpackDevServer by a socket and get notified about changes.\n    // When you save a file, the client will either apply hot updates (in case\n    // of CSS changes), or refresh the page (in case of JS changes). When you\n    // make a syntax error, this client will display a syntax error overlay.\n    // Note: instead of the default WebpackDevServer client, we use a custom one\n    // to bring better experience for Create React App users. You can replace\n    // the line below with these two lines if you prefer the stock client:\n    // require.resolve('webpack-dev-server/client') + '?/',\n    // require.resolve('webpack/hot/dev-server'),\n    appEntry.unshift(require.resolve('react-dev-utils/webpackHotDevClient'));\n  }\n\n  let webpackConfig: DevConfiguration = {\n    mode,\n    entry: {\n      app: appEntry,\n    },\n    // https://webpack.js.org/configuration/other-options/#bail\n    // Fail out on the first error instead of tolerating it.\n    bail: isProd,\n    devtool,\n    context: __dirname,\n    // configures where the build ends up\n    output: getOutput(locations, mode, publicPath),\n    plugins: [\n      // Delete the build folder\n      isProd &&\n        new CleanWebpackPlugin([locations.production.folder], {\n          root: locations.root,\n          dry: false,\n          verbose: false,\n        }),\n      // Copy the template files over\n      isProd &&\n        new CopyWebpackPlugin([\n          {\n            from: locations.template.folder,\n            to: locations.production.folder,\n            // We generate new versions of these based on the templates\n            ignore: ['expo-service-worker.js', 'favicon.ico', 'serve.json', 'index.html', 'icon.png'],\n          },\n          {\n            from: locations.template.serveJson,\n            to: locations.production.serveJson,\n          },\n          {\n            from: locations.template.favicon,\n            to: locations.production.favicon,\n          },\n          {\n            from: locations.template.serviceWorker,\n            to: locations.production.serviceWorker,\n          },\n        ]),\n\n      // Generate the `index.html`\n      new ExpoHtmlWebpackPlugin(env),\n\n      // Add variables to the `index.html`\n      new InterpolateHtmlPlugin(ExpoHtmlWebpackPlugin, {\n        WEB_PUBLIC_URL: publicPath,\n        WEB_TITLE: config.web.name,\n        NO_SCRIPT: noJSComponent,\n        LANG_ISO_CODE: lang,\n        ROOT_ID: rootId,\n      }),\n\n      new WebpackPWAManifestPlugin(config, {\n        publicPath,\n        noResources: isDev || !env.pwa,\n        filename: locations.production.manifest,\n        HtmlWebpackPlugin: ExpoHtmlWebpackPlugin,\n      }),\n\n      // This gives some necessary context to module not found errors, such as\n      // the requesting resource.\n      new ModuleNotFoundPlugin(locations.root),\n\n      new ExpoDefinePlugin({\n        mode,\n        publicUrl,\n        config,\n        productionManifestPath: locations.production.manifest,\n      }),\n\n      // This is necessary to emit hot updates (currently CSS only):\n      isDev && new HotModuleReplacementPlugin(),\n\n      // If you require a missing module and then `npm install` it, you still have\n      // to restart the development server for Webpack to discover it. This plugin\n      // makes the discovery automatic so you don't have to restart.\n      // See https://github.com/facebook/create-react-app/issues/186\n      isDev && new WatchMissingNodeModulesPlugin(locations.modules),\n\n      isProd &&\n        new MiniCssExtractPlugin({\n          // Options similar to the same options in webpackOptions.output\n          // both options are optional\n          filename: 'static/css/[name].[contenthash:8].css',\n          chunkFilename: 'static/css/[name].[contenthash:8].chunk.css',\n        }),\n\n      // Generate a manifest file which contains a mapping of all asset filenames\n      // to their corresponding output file so that tools can pick it up without\n      // having to parse `index.html`.\n      new ManifestPlugin({\n        fileName: 'asset-manifest.json',\n        publicPath,\n      }),\n\n      deepScopeAnalysisEnabled && new WebpackDeepScopeAnalysisPlugin(),\n\n      new ExpoProgressBarPlugin(),\n    ].filter(Boolean),\n    module: {\n      strictExportPresence: false,\n      rules: [\n        // Disable require.ensure because it breaks tree shaking.\n        { parser: { requireEnsure: false } },\n        {\n          oneOf: createAllLoaders(env),\n        },\n      ].filter(Boolean),\n    },\n\n    resolveLoader: {\n      plugins: [\n        // Also related to Plug'n'Play, but this time it tells Webpack to load its loaders\n        // from the current package.\n        PnpWebpackPlugin.moduleLoader(module),\n      ],\n    },\n    resolve: {\n      alias: DEFAULT_ALIAS,\n      mainFields: ['browser', 'module', 'main'],\n      extensions: getModuleFileExtensions('web'),\n      plugins: [\n        // Adds support for installing with Plug'n'Play, leading to faster installs and adding\n        // guards against forgotten dependencies and such.\n        PnpWebpackPlugin,\n        // Prevents users from importing files from outside of node_modules/.\n        // This often causes confusion because we only process files within the root folder with babel.\n        // To fix this, we prevent you from importing files out of the root folder -- if you'd like to,\n        // please link the files into your node_modules/ and let module-resolution kick in.\n        // Make sure your source files are compiled, as they will not be processed in any way.\n        new ModuleScopePlugin(babelProjectRoot, [locations.packageJson]),\n      ],\n      symlinks: false,\n    },\n    // Turn off performance processing because we utilize\n    // our own (CRA) hints via the FileSizeReporter\n    performance: boolish('CI', false) ? false : undefined,\n  };\n\n  if (isDev) {\n    webpackConfig.devServer = await createDevServerConfigAsync(env, argv);\n  } else if (isProd) {\n    webpackConfig = withCompression(withOptimizations(webpackConfig), env);\n  }\n\n  return withReporting(withNodeMocks(webpackConfig), env);\n}\n\n// Some libraries import Node modules but don't use them in the browser.\n// Tell Webpack to provide empty mocks for them so importing them works.\nfunction withNodeMocks(webpackConfig: Configuration | DevConfiguration): Configuration | DevConfiguration {\n  webpackConfig.node = {\n    ...(webpackConfig.node || {}),\n    module: 'empty',\n    dgram: 'empty',\n    dns: 'mock',\n    fs: 'empty',\n    http2: 'empty',\n    net: 'empty',\n    tls: 'empty',\n    child_process: 'empty',\n  }\n  return webpackConfig;\n}\n"]}